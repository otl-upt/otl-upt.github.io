import{S as U,i as V,s as q,p as v,e as $,a as K,b as I,c as M,d as y,K as E,M as se,L as F,m as w,o as D,g as P,v as R,F as S,n as L,q as ne,w as ce,t as re,h as oe,N as ie,z as ae,C as T,D as N,E as j,G as B,H as ue}from"./vendor.svelte-3e68128c.js";import{c as fe,C as _e,d as he,a as me,b as de}from"./lib-0f2b3b81.js";const pe=async n=>{const l=n.MaintenanceV1,t=l.PMDueV1,o=l.PMDueDetailsV1;return{rows:t,rowDetails:o.map(r=>({Terminal:r.shop_name,Unit:r.unitnumber,Type:r.type,DuePct:r.duepercent,Interval:r.interval,Utilization:r.utilization,Factor:r.metertype,Description:r.description,unittype:r.unittype})).sort((r,s)=>r.Unit.localeCompare(s.Unit)||r.Type.localeCompare(s.Type))}};function G(n,e,l){const t=n.slice();return t[11]=e[l],t}function H(n,e,l){const t=n.slice();return t[14]=e[l],t}function O(n,e,l){const t=n.slice();return t[17]=e[l],t}function A(n,e,l){const t=n.slice();return t[11]=e[l],t}function J(n,e,l){const t=n.slice();return t[11]=e[l],t}function Q(n){let e;return{c(){e=$("th"),e.textContent=`${n[11]}`},m(l,t){M(l,e,t)},p:L,d(l){l&&P(e)}}}function W(n){let e,l=n[14][n[11]]+"",t;return{c(){e=$("td"),t=re(l)},m(o,r){M(o,e,r),y(e,t)},p(o,r){r&1&&l!==(l=o[14][o[11]]+"")&&oe(t,l)},d(o){o&&P(e)}}}function X(n){let e,l,t,o=v([...new Set(n[5](n[14][n[1]]).map(ee))]),r=[];for(let a=0;a<o.length;a+=1)r[a]=Y(O(n,o,a));const s=a=>D(r[a],1,1,()=>{r[a]=null});return{c(){e=$("tr"),l=$("td");for(let a=0;a<r.length;a+=1)r[a].c();I(l,"colspan",n[6].length)},m(a,g){M(a,e,g),y(e,l);for(let _=0;_<r.length;_+=1)r[_]&&r[_].m(l,null);t=!0},p(a,g){if(g&35){o=v([...new Set(a[5](a[14][a[1]]).map(ee))]);let _;for(_=0;_<o.length;_+=1){const m=O(a,o,_);r[_]?(r[_].p(m,g),w(r[_],1)):(r[_]=Y(m),r[_].c(),w(r[_],1),r[_].m(l,null))}for(E(),_=o.length;_<r.length;_+=1)s(_);F()}},i(a){if(!t){for(let g=0;g<o.length;g+=1)w(r[g]);t=!0}},o(a){r=r.filter(Boolean);for(let g=0;g<r.length;g+=1)D(r[g]);t=!1},d(a){a&&P(e),R(r,a)}}}function Y(n){let e,l;function t(...o){return n[9](n[17],...o)}return e=new fe({props:{rows:n[5](n[14][n[1]]).filter(t).sort(te).map(le),twist:!1,caption:n[17].replace(" ","")}}),{c(){T(e.$$.fragment)},m(o,r){N(e,o,r),l=!0},p(o,r){n=o;const s={};r&3&&(s.rows=n[5](n[14][n[1]]).filter(t).sort(te).map(le)),r&3&&(s.caption=n[17].replace(" ","")),e.$set(s)},i(o){l||(w(e.$$.fragment,o),l=!0)},o(o){D(e.$$.fragment,o),l=!1},d(o){j(e,o)}}}function Z(n,e){let l,t,o=e[2].includes(e[14][e[1]]),r,s,a,g,_=v(e[6]),m=[];for(let u=0;u<_.length;u+=1)m[u]=W(A(e,_,u));function C(...u){return e[8](e[14],...u)}let d=o&&X(e);return{key:n,first:null,c(){l=$("tr");for(let u=0;u<m.length;u+=1)m[u].c();t=K(),d&&d.c(),r=ne(),this.first=l},m(u,f){M(u,l,f);for(let h=0;h<m.length;h+=1)m[h]&&m[h].m(l,null);M(u,t,f),d&&d.m(u,f),M(u,r,f),s=!0,a||(g=ce(l,"click",C),a=!0)},p(u,f){if(e=u,f&65){_=v(e[6]);let h;for(h=0;h<_.length;h+=1){const b=A(e,_,h);m[h]?m[h].p(b,f):(m[h]=W(b),m[h].c(),m[h].m(l,null))}for(;h<m.length;h+=1)m[h].d(1);m.length=_.length}f&7&&(o=e[2].includes(e[14][e[1]])),o?d?(d.p(e,f),f&7&&w(d,1)):(d=X(e),d.c(),w(d,1),d.m(r.parentNode,r)):d&&(E(),D(d,1,1,()=>{d=null}),F())},i(u){s||(w(d),s=!0)},o(u){D(d),s=!1},d(u){u&&(P(l),P(t),P(r)),R(m,u),d&&d.d(u),a=!1,g()}}}function x(n){let e,l=(n[11]===n[1]?"Total":n[0].reduce(r,0))+"",t,o;function r(...s){return n[10](n[11],...s)}return{c(){e=$("td"),t=re(l),o=K()},m(s,a){M(s,e,a),y(e,t),y(e,o)},p(s,a){n=s,a&3&&l!==(l=(n[11]===n[1]?"Total":n[0].reduce(r,0))+"")&&oe(t,l)},d(s){s&&P(e)}}}function ge(n){let e,l,t,o,r,s,a=[],g=new Map,_,m,C,d=v(n[6]),u=[];for(let c=0;c<d.length;c+=1)u[c]=Q(J(n,d,c));let f=v(n[0]);const h=c=>c[14][c[1]];for(let c=0;c<f.length;c+=1){let p=H(n,f,c),i=h(p);g.set(i,a[c]=Z(i,p))}let b=v(n[6]),k=[];for(let c=0;c<b.length;c+=1)k[c]=x(G(n,b,c));return{c(){e=$("div"),l=$("table"),t=$("thead"),o=$("tr");for(let c=0;c<u.length;c+=1)u[c].c();r=K(),s=$("tbody");for(let c=0;c<a.length;c+=1)a[c].c();_=K(),m=$("tr");for(let c=0;c<k.length;c+=1)k[c].c();I(o,"class","table-light"),I(m,"class","table-dark"),I(l,"class","table table-hover table-borderless table-sm align-middle"),I(e,"class","table-responsive m-0 mt-2 m-lg-4")},m(c,p){M(c,e,p),y(e,l),y(l,t),y(t,o);for(let i=0;i<u.length;i+=1)u[i]&&u[i].m(o,null);y(l,r),y(l,s);for(let i=0;i<a.length;i+=1)a[i]&&a[i].m(s,null);y(s,_),y(s,m);for(let i=0;i<k.length;i+=1)k[i]&&k[i].m(m,null);C=!0},p(c,[p]){if(p&64){d=v(c[6]);let i;for(i=0;i<d.length;i+=1){const z=J(c,d,i);u[i]?u[i].p(z,p):(u[i]=Q(z),u[i].c(),u[i].m(o,null))}for(;i<u.length;i+=1)u[i].d(1);u.length=d.length}if(p&119&&(f=v(c[0]),E(),a=se(a,p,h,1,c,f,g,s,ie,Z,_,H),F()),p&67){b=v(c[6]);let i;for(i=0;i<b.length;i+=1){const z=G(c,b,i);k[i]?k[i].p(z,p):(k[i]=x(z),k[i].c(),k[i].m(m,null))}for(;i<k.length;i+=1)k[i].d(1);k.length=b.length}},i(c){if(!C){for(let p=0;p<f.length;p+=1)w(a[p]);C=!0}},o(c){for(let p=0;p<a.length;p+=1)D(a[p]);C=!1},d(c){c&&P(e),R(u,c);for(let p=0;p<a.length;p+=1)a[p].d();R(k,c)}}}const ee=n=>n.unittype,te=(n,e)=>e.DuePct-n.DuePct,le=({unittype:n,...e})=>e;function be(n,e,l){let t,{rows:o=[]}=e,{rowDetails:r=[]}=e,{keyName:s=""}=e,a=ae([]);S(n,a,f=>l(2,t=f));const g=({[s]:f})=>a.update(h=>t.includes(f)?h.filter(b=>b!==f):[...h,f]),_=f=>r.filter(h=>h[s]===f).map(({[s]:h,...b})=>b);let m=o.length>0?Object.keys(o[0]):[];const C=(f,h)=>g(f),d=(f,h)=>h.unittype===f,u=(f,h,b)=>h+b[f];return n.$$set=f=>{"rows"in f&&l(0,o=f.rows),"rowDetails"in f&&l(7,r=f.rowDetails),"keyName"in f&&l(1,s=f.keyName)},[o,s,t,a,g,_,m,r,C,d,u]}class ke extends U{constructor(e){super(),V(this,e,be,ge,q,{rows:0,rowDetails:7,keyName:1})}}function we(n){let e,l;return e=new me({props:{error:n[5]}}),{c(){T(e.$$.fragment)},m(t,o){N(e,t,o),l=!0},p(t,o){const r={};o&2&&(r.error=t[5]),e.$set(r)},i(t){l||(w(e.$$.fragment,t),l=!0)},o(t){D(e.$$.fragment,t),l=!1},d(t){j(e,t)}}}function $e(n){let e,l;return e=new ke({props:{rows:n[4].rows,rowDetails:n[4].rowDetails,keyName:"Terminal"}}),{c(){T(e.$$.fragment)},m(t,o){N(e,t,o),l=!0},p(t,o){const r={};o&2&&(r.rows=t[4].rows),o&2&&(r.rowDetails=t[4].rowDetails),e.$set(r)},i(t){l||(w(e.$$.fragment,t),l=!0)},o(t){D(e.$$.fragment,t),l=!1},d(t){j(e,t)}}}function De(n){let e,l;return e=new de({}),{c(){T(e.$$.fragment)},m(t,o){N(e,t,o),l=!0},p:L,i(t){l||(w(e.$$.fragment,t),l=!0)},o(t){D(e.$$.fragment,t),l=!1},d(t){j(e,t)}}}function ye(n){let e,l,t,o={ctx:n,current:null,token:null,hasCatch:!0,pending:De,then:$e,catch:we,value:4,error:5,blocks:[,,,]};return B(l=n[3](n[1]),o),{c(){e=ne(),o.block.c()},m(r,s){M(r,e,s),o.block.m(r,o.anchor=s),o.mount=()=>e.parentNode,o.anchor=e,t=!0},p(r,s){n=r,o.ctx=n,s&2&&l!==(l=n[3](n[1]))&&B(l,o)||ue(o,n,s)},i(r){t||(w(o.block),t=!0)},o(r){for(let s=0;s<3;s+=1){const a=o.blocks[s];D(a)}t=!1},d(r){r&&P(e),o.block.d(r),o.token=null,o=null}}}function ve(n){let e,l;return e=new _e({props:{size:Me,title:Pe,tds:n[0],$$slots:{default:[ye]},$$scope:{ctx:n}}}),{c(){T(e.$$.fragment)},m(t,o){N(e,t,o),l=!0},p(t,[o]){const r={};o&1&&(r.tds=t[0]),o&66&&(r.$$scope={dirty:o,ctx:t}),e.$set(r)},i(t){l||(w(e.$$.fragment,t),l=!0)},o(t){D(e.$$.fragment,t),l=!1},d(t){j(e,t)}}}const Me=12,Pe="PM Due";function Ce(n,e,l){let t,o;S(n,he,a=>l(1,o=a));const r=ae(new Date);return S(n,r,a=>l(0,t=a)),[t,o,r,async a=>{const _=a.MaintenanceV1,m=await pe(a);return r.set(_.tds),m}]}class Te extends U{constructor(e){super(),V(this,e,Ce,ve,q,{})}}function Ne(n){let e,l;return e=new Te({}),{c(){T(e.$$.fragment)},m(t,o){N(e,t,o),l=!0},p:L,i(t){l||(w(e.$$.fragment,t),l=!0)},o(t){D(e.$$.fragment,t),l=!1},d(t){j(e,t)}}}class Ie extends U{constructor(e){super(),V(this,e,null,Ne,q,{})}}export{Ie as M};
